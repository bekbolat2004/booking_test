# Booking System API

### Описание

Это REST API для системы бронирования ресурсов (переговорных комнат) с поддержкой системы очередей и временных зон. 
API позволяет пользователям создавать бронирования, отменять их, а также управлять очередями на ресурсы. 
Время бронирований должно находиться в будущем, и каждый пользователь может забронировать один ресурс только один раз в течение 24 часов.

## Функциональные возможности

> - #### Создание бронирований, если ресурс доступен на выбранное время.
> - ####  Добавление в очередь, если все слоты заняты.
> - #### Автоматическое уведомление (через консоль) о продвижении в очереди, когда ресурс освобождается.
> - #### Ограничение бронирования одним пользователем на ресурс: не более одного бронирования за 24 часа.
> - #### Бронирование только на будущее время: нельзя забронировать ресурс на прошлое.
> - #### Автоматическое обновление статуса очереди при завершении или отмене бронирования.
>

***

## Технологии

- Python 3.9+
- Django 3.2+
- Django REST Framework
- SQLlite


## Установка и запуск
### 1.Клонируйте репозиторий:
>git clone https://github.com/bekbolat2004/booking_test.git
> 
>cd booking_system_test

### 2.Создайте и активируйте виртуальное окружение:
>python -m venv venv
> 
>Для Windows: venv\Scripts\activate
>
>Для Mac/Linux: venv/bin/activate

### 3.Установите зависимости:
>
> pip install -r requirements.txt
> 

### 4.Примените миграции и запустите сервер:
>python manage.py makemigrations
>
>python manage.py migrate
>
>python manage.py runserver
>

## API Эндпоинты
### Базовый URL:
> http://localhost:8000/api/

### Аутентификация

> API требует аутентификацию пользователей. Django использует встроенную модель пользователя, а для тестирования можно использовать команду createsuperuser для создания пользователя-администратора

### Эндпоинты:

#### 1. Создание бронирования
 - URL: /api/bookings/
 - Метод: POST
 - Описание: Создает бронирование ресурса на указанное время. Если слоты заняты, пользователь будет добавлен в очередь.

#### 2. Отмена бронирования
 - URL: /api/bookings/<id>/
 - Метод: DELETE
 - Описание: Удаляет бронирование и продвигает следующий элемент в очереди, если таковой имеется.

#### 3. Получение списка бронирований
 - URL: /api/bookings/
 - Метод: GET
 - Описание: Возвращает список всех бронирований, включая бронирования в очереди

#### 4. Изменение статуса бронирования на завершенное

 - URL: /api/bookings/<id>/
 - Метод: PATCH
 - Описание: Изменяет статус бронирования на completed, после чего следующий пользователь в очереди продвигается на активное бронирование.

#### 5.Создание ресурса (административный эндпоинт)

 - URL: /api/resources/
 - Метод: POST
 - Описание: Администратор может создавать ресурсы (например, комнаты).


## Основная логика работы API:

### 1. Проверка времени начала бронирования
>API не допускает создание бронирования с временем начала в прошлом. Все бронирования должны начинаться в будущем относительно текущего времени.

### 2. Ограничение бронирований для пользователей
>Каждый пользователь может забронировать один ресурс только один раз в течение 24 часов. API автоматически проверяет наличие активных или завершенных бронирований за последние 24 часа перед созданием нового бронирования.

### 3. Очередь
> Если все слоты для ресурса заняты, пользователь будет добавлен в очередь. Очередь работает по принципу FIFO (First In, First Out). Когда активное бронирование завершается или отменяется, следующий пользователь в очереди автоматически получает слот для бронирования.

### 4. Работа с временными зонами
>Все времена в базе данных хранятся в формате UTC для стандартизации и поддержки разных временных зон пользователей. 
>При необходимости, перед выводом времени пользователю, время может быть преобразовано в его локальную временную зону. В моем случае я использую UTC+5:00 Asia/Almaty.